<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Random effects in baseline logit models and conditional logit models ‚Ä¢ mclogit</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Random effects in baseline logit models and conditional logit models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mclogit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>The statistical models</h6></li>
    <li><a class="dropdown-item" href="../articles/conditional-logit.html">Conditional logit models</a></li>
    <li><a class="dropdown-item" href="../articles/baseline-logit.html">Baseline-category logit models</a></li>
    <li><a class="dropdown-item" href="../articles/baseline-and-conditional-logit.html">The relation between baseline logit and conditional logit models</a></li>
    <li><a class="dropdown-item" href="../articles/random-effects.html">Random effects in baseline logit models and conditional logit models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Technical aspects of model fitting</h6></li>
    <li><a class="dropdown-item" href="../articles/fitting-mclogit.html">The IWLS algorithm used to fit conditional logit models</a></li>
    <li><a class="dropdown-item" href="../articles/approximations.html">Approximate Inference for Multinomial Logit Models with Random Effects</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/melff/mclogit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Random effects in baseline logit models and conditional logit models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/melff/mclogit/blob/main/vignettes/random-effects.Rmd" class="external-link"><code>vignettes/random-effects.Rmd</code></a></small>
      <div class="d-none name"><code>random-effects.Rmd</code></div>
    </div>

    
    
<p>The ‚Äúmclogit‚Äù package allows for the presence of random effects in
baseline-category logit and conditional logit models. In
baseline-category logit models, the random effects may represent
(unobserved) characteristics that are common the individuals in
clusters, such as regional units or electoral districts or the like. In
conditional logit models, random effects may represent attributes that
share across several choice occasions within the same context of choice.
That is, if one analyses voting behaviour across countries then an
random effect specific to the Labour party may represent unobserved
attributes of this party in terms of which it differs from (or is more
like) the Social Democratic Party of Germany (SPD). My original
motivation for working on conditional logit models with random effects
was to make it possible to assess the impact of parties‚Äô political
positions on the patterns of voting behaviour in various European
countries. The results of this research are published in an article in
<span class="citation">Elff (2009)</span>.</p>
<p>In its earliest incarnation, the package supported only a very simple
random-intercept extension of conditional logit models (or ‚Äúmixed
conditional logit models‚Äù, hence the name of the package). These models
can be written as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÄ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>‚àë</mo><mrow><mi>k</mi><mo>‚àà</mo><msub><mi>ùíÆ</mi><mi>i</mi></msub></mrow></munder><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\pi_{ij} = \frac{\exp(\eta_{ij})}{\sum_{k\in\mathcal{S}_i}\exp(\eta_{ik})}
</annotation></semantics></math></p>
<p>with</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∑</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>‚àë</mo><mi>h</mi></munder><msub><mi>Œ±</mi><mi>h</mi></msub><msub><mi>x</mi><mrow><mi>h</mi><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><munder><mo>‚àë</mo><mi>k</mi></munder><msub><mi>z</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>b</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\eta_{ij}=\sum_h\alpha_hx_{hij}+\sum_kz_{ik}b_{jk}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>h</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">x_{hij}</annotation></semantics></math>
represents values of independent variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\alpha_h</annotation></semantics></math>
are coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">z_{ik}</annotation></semantics></math>
are dummy ariables (that are equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is in cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
otherwise),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">b_{jk}</annotation></semantics></math>
are random effects with a normal distribution with expectation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
and variance parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÉ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>.</p>
<p>Later releases also added support for baseline-category logit models
(initially only without random effects). In order to support random
effects in baseline-category logit models, the package had to be further
modified to allow for conditional logit models with random slopes (this
is so because baseline-categoy logit models can be expressed as a
particular type of conditional logit models).</p>
<p>It should be noted that estimating the parameters of random effects
multinomial logit models (whether of baseline-category logit variety or
the conditional logit variety) involves the considerable challenges
already known from the ‚Äúgeneralized linear mixed models‚Äù literature. The
main challenge is that the likelihood function involves analytically
intractable integrals (i.e.¬†there is know way to ‚Äúsolve‚Äù or eliminate
the intergrals from the formula of the likelihood function). This means
that either computationally intensive methods for the computation of
such integrals have to be used or certain approximations (most notably
the Laplace approximation technique and its variants), which may lead to
biases in certain situations. The ‚Äúmclogit‚Äù package only supports
approximate likelihood-based inference. Most of the time the
PQL-technique based on a (first-order) Laplace approximation was
supported, release 0.8, ‚Äúmclogit‚Äù also supports the MQL technique, which
is based on a (first-order) Solomon-Cox approximation. The ideas behind
the PQL and MQL techniques are described e.g.¬†in <span class="citation">Breslow and Clayton (1993)</span>.</p>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-breslow.clayton:approximate.inference.glmm" class="csl-entry">
Breslow, Norman E., and David G. Clayton. 1993. <span>‚ÄúApproximate
Inference in Generalized Linear Mixed Models.‚Äù</span> <em>Journal of the
American Statistical Association</em> 88 (421): 9‚Äì25.
</div>
<div id="ref-elff:divisions.positions.voting" class="csl-entry">
Elff, Martin. 2009. <span>‚ÄúSocial Divisions, Party Positions, and
Electoral Behaviour.‚Äù</span> <em>Electoral Studies</em> 28 (2): 297‚Äì308.
<a href="https://doi.org/10.1016/j.electstud.2009.02.002" class="external-link">https://doi.org/10.1016/j.electstud.2009.02.002</a>.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Elff.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
