<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Random effects in baseline logit models and conditional logit models ‚Ä¢ mclogit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Random effects in baseline logit models and conditional logit models">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mclogit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">The statistical models</li>
    <li>
      <a href="../articles/conditional-logit.html">Conditional logit models</a>
    </li>
    <li>
      <a href="../articles/baseline-logit.html">Baseline-category logit models</a>
    </li>
    <li>
      <a href="../articles/baseline-and-conditional-logit.html">The relation between baseline logit and conditional logit models</a>
    </li>
    <li>
      <a href="../articles/random-effects.html">Random effects in baseline logit models and conditional logit models</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Technical aspects of model fitting</li>
    <li>
      <a href="../articles/fitting-mclogit.html">The IWLS algorithm used to fit conditional logit models</a>
    </li>
    <li>
      <a href="../articles/approximations.html">Approximate Inference for Multinomial Logit Models with Random Effects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/melff/mclogit/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>




      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Random effects in baseline logit models and
conditional logit models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/melff/mclogit/blob/main/vignettes/random-effects.Rmd" class="external-link"><code>vignettes/random-effects.Rmd</code></a></small>
      <div class="hidden name"><code>random-effects.Rmd</code></div>

    </div>

    
    
<p>The ‚Äúmclogit‚Äù package allows for the presence of random effects in
baseline-category logit and conditional logit models. In
baseline-category logit models, the random effects may represent
(unobserved) characteristics that are common the individuals in
clusters, such as regional units or electoral districts or the like. In
conditional logit models, random effects may represent attributes that
share across several choice occasions within the same context of choice.
That is, if one analyses voting behaviour across countries then an
random effect specific to the Labour party may represent unobserved
attributes of this party in terms of which it differs from (or is more
like) the Social Democratic Party of Germany (SPD). My original
motivation for working on conditional logit models with random effects
was to make it possible to assess the impact of parties‚Äô political
positions on the patterns of voting behaviour in various European
countries. The results of this research are published in an article in
<span class="citation">Elff (2009)</span>.</p>
<p>In its earliest incarnation, the package supported only a very simple
random-intercept extension of conditional logit models (or ‚Äúmixed
conditional logit models‚Äù, hence the name of the package). These models
can be written as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÄ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>‚àë</mo><mrow><mi>k</mi><mo>‚àà</mo><msub><mi>ùíÆ</mi><mi>i</mi></msub></mrow></munder><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\pi_{ij} = \frac{\exp(\eta_{ij})}{\sum_{k\in\mathcal{S}_i}\exp(\eta_{ik})}
</annotation></semantics></math></p>
<p>with</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∑</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>‚àë</mo><mi>h</mi></munder><msub><mi>Œ±</mi><mi>h</mi></msub><msub><mi>x</mi><mrow><mi>h</mi><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><munder><mo>‚àë</mo><mi>k</mi></munder><msub><mi>z</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>b</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\eta_{ij}=\sum_h\alpha_hx_{hij}+\sum_kz_{ik}b_{jk}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>h</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">x_{hij}</annotation></semantics></math>
represents values of independent variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\alpha_h</annotation></semantics></math>
are coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">z_{ik}</annotation></semantics></math>
are dummy ariables (that are equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is in cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
otherwise),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">b_{jk}</annotation></semantics></math>
are random effects with a normal distribution with expectation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
and variance parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÉ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>.</p>
<p>Later releases also added support for baseline-category logit models
(initially only without random effects). In order to support random
effects in baseline-category logit models, the package had to be further
modified to allow for conditional logit models with random slopes (this
is so because baseline-categoy logit models can be expressed as a
particular type of conditional logit models).</p>
<p>It should be noted that estimating the parameters of random effects
multinomial logit models (whether of baseline-category logit variety or
the conditional logit variety) involves the considerable challenges
already known from the ‚Äúgeneralized linear mixed models‚Äù literature. The
main challenge is that the likelihood function involves analytically
intractable integrals (i.e.¬†there is know way to ‚Äúsolve‚Äù or eliminate
the intergrals from the formula of the likelihood function). This means
that either computationally intensive methods for the computation of
such integrals have to be used or certain approximations (most notably
the Laplace approximation technique and its variants), which may lead to
biases in certain situations. The ‚Äúmclogit‚Äù package only supports
approximate likelihood-based inference. Most of the time the
PQL-technique based on a (first-order) Laplace approximation was
supported, release 0.8, ‚Äúmclogit‚Äù also supports the MQL technique, which
is based on a (first-order) Solomon-Cox approximation. The ideas behind
the PQL and MQL techniques are described e.g.¬†in <span class="citation">Breslow and Clayton (1993)</span>.</p>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-breslow.clayton:approximate.inference.glmm" class="csl-entry">
Breslow, Norman E., and David G. Clayton. 1993. <span>‚ÄúApproximate
Inference in Generalized Linear Mixed Models.‚Äù</span> <em>Journal of the
American Statistical Association</em> 88 (421): 9‚Äì25.
</div>
<div id="ref-elff:divisions.positions.voting" class="csl-entry">
Elff, Martin. 2009. <span>‚ÄúSocial Divisions, Party Positions, and
Electoral Behaviour.‚Äù</span> <em>Electoral Studies</em> 28 (2): 297‚Äì308.
<a href="https://doi.org/10.1016/j.electstud.2009.02.002" class="external-link">https://doi.org/10.1016/j.electstud.2009.02.002</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin Elff.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer>
</div>






  </body>
</html>
