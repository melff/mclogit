<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Conditional Logit Models and Mixed Conditional Logit Models — mclogit • mclogit</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conditional Logit Models and Mixed Conditional Logit Models — mclogit"><meta name="description" content="mclogit fits conditional logit models and mixed conditional
  logit models to count data and individual choice data,
  where the choice set may vary across choice occasions.
Conditional logit models without random effects are fitted by
  Fisher-scoring/IWLS. Models with random effects
  (mixed conditional logit models) are estimated via maximum likelihood
  with a simple Laplace aproximation (aka PQL)."><meta property="og:description" content="mclogit fits conditional logit models and mixed conditional
  logit models to count data and individual choice data,
  where the choice set may vary across choice occasions.
Conditional logit models without random effects are fitted by
  Fisher-scoring/IWLS. Models with random effects
  (mixed conditional logit models) are estimated via maximum likelihood
  with a simple Laplace aproximation (aka PQL)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mclogit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>The statistical models</h6></li>
    <li><a class="dropdown-item" href="../articles/conditional-logit.html">Conditional logit models</a></li>
    <li><a class="dropdown-item" href="../articles/baseline-logit.html">Baseline-category logit models</a></li>
    <li><a class="dropdown-item" href="../articles/baseline-and-conditional-logit.html">The relation between baseline logit and conditional logit models</a></li>
    <li><a class="dropdown-item" href="../articles/random-effects.html">Random effects in baseline logit models and conditional logit models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Technical aspects of model fitting</h6></li>
    <li><a class="dropdown-item" href="../articles/fitting-mclogit.html">The IWLS algorithm used to fit conditional logit models</a></li>
    <li><a class="dropdown-item" href="../articles/approximations.html">Approximate Inference for Multinomial Logit Models with Random Effects</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/melff/mclogit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Conditional Logit Models and Mixed Conditional Logit Models</h1>

      <div class="d-none name"><code>mclogit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>mclogit</code> fits conditional logit models and mixed conditional
  logit models to count data and individual choice data,
  where the choice set may vary across choice occasions.</p>
<p>Conditional logit models without random effects are fitted by
  Fisher-scoring/IWLS. Models with random effects
  (mixed conditional logit models) are estimated via maximum likelihood
  with a simple Laplace aproximation (aka PQL).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mclogit</span><span class="op">(</span><span class="va">formula</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>, random<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>        <span class="va">subset</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, offset<span class="op">=</span><span class="cn">NULL</span>, na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"na.action"</span><span class="op">)</span>,</span>
<span>        model <span class="op">=</span> <span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">FALSE</span>, y <span class="op">=</span> <span class="cn">TRUE</span>, contrasts<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>        method <span class="op">=</span> <span class="cn">NULL</span>, estimator<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ML"</span>,<span class="st">"REML"</span><span class="op">)</span>,</span>
<span>        dispersion <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        start<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>        groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        control<span class="op">=</span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">random</span><span class="op">)</span><span class="op">)</span></span>
<span>                    <span class="fu"><a href="mclogit_control.html">mmclogit.control</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>                <span class="kw">else</span> <span class="fu"><a href="mclogit_control.html">mclogit.control</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mclogit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">formula.</span>, <span class="va">dispersion</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mclogit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, dispersion <span class="op">=</span> <span class="cn">NULL</span>, correlation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        symbolic.cor <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a model formula: a symbolic description of the
    model to be fitted. The left-hand side should result in
    a two-column matrix. The first column contains
    the choice counts or choice indicators (alternative is
    chosen=1, is not chosen=0). The second column contains
    unique numbers for each choice set.</p>
<p>The left-hand side can either take the form <code>cbind(choice,set)</code>
    or (from version 0.9.1) <code>choice|set</code></p>
<p>If individual-level data is used, choice sets correspond
    to individuals, if aggregated data with choice counts are used,
    choice sets usually correspond to covariate classes.</p>
<p>The right-hand of the formula contains choice predictors. It should be noted
    that constants are deleted from the formula as are predictors that do not vary
    within choice sets.</p></dd>


  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame, list or environment (or object
    coercible by <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code> to a data frame) containing
    the variables in the model.  If not found in <code>data</code>, the
    variables are taken from <code>environment(formula)</code>,
    typically the environment from which <code>glm</code> is called.</p></dd>


  <dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>an optional formula or list of formulas that specify the
    random-effects structure or NULL.</p></dd>


  <dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional vector specifying a subset of observations
    to be used in the fitting process.</p></dd>


  <dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional vector of weights to be used in the fitting
    process.  Should be <code>NULL</code> or a numeric vector.</p></dd>


  <dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>an optional model offset.</p></dd>


  <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function which indicates what should happen
    when the data contain <code>NA</code>s.  The default is set by
    the <code>na.action</code> setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></code>, and is
    <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code> if that is unset.  The ‘factory-fresh’
    default is <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code>.  Another possible value is
    <code>NULL</code>, no action.  Value <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code> can be useful.</p></dd>


  <dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>an optional numerical vector of starting values for the
    conditional logit parameters.  If the model has random effects, the
    vector should have a "VarCov" attribute wtih starting values for the
    random effects (co-)variances. If the random effects model is
    estimated with the "PQL" method, the starting values matrix should
    also have a "random.effects" attribute, which should have the same
    structure as the "random.effects" component of an object returned by
    <code><a href="mblogit.html">mblogit()</a></code>.</p></dd>


  <dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a logical value indicating whether <em>model frame</em>
    should be included as a component of the returned value.</p></dd>


  <dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>logical values indicating whether the response vector and model
    matrix used in the fitting process should be returned as components
    of the returned value.</p></dd>


  <dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>an optional list. See the <code>contrasts.arg</code>
    of <code>model.matrix.default</code>.</p></dd>


  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>NULL</code> or a character string, either "PQL" or "MQL", specifies
      the type of the quasilikelihood approximation to be used if
      a random-effects model is to be estimated.</p></dd>


  <dt id="arg-estimator">estimator<a class="anchor" aria-label="anchor" href="#arg-estimator"></a></dt>
<dd><p>a character string; either "ML" or "REML",
    specifies which estimator is to be used/approximated.</p></dd>


  <dt id="arg-dispersion">dispersion<a class="anchor" aria-label="anchor" href="#arg-dispersion"></a></dt>
<dd><p>a real number used as dispersion parameter;
    a character vector that specifies the method to compute the dispersion;
    a logical value – if <code>TRUE</code> the default method
    (<code>"Afroz"</code>) is used, if <code>FALSE</code>, the dispersion parameter
    is set to 1, that is, no dispersion. For details see <code><a href="dispersion.html">dispersion</a></code>.</p></dd>


  <dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>an optional formula that specifies groups of observations
    relevant for the estimation of overdispersion. Covariates should be
    constant within groups, otherwise a warning is generated
    since the overdispersion estimate may
    be imprecise.</p></dd>


  <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list of parameters for the fitting process.
    See <code><a href="mclogit_control.html">mclogit.control</a></code></p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments to be passed to <code>mclogit.control</code> or <code>mmclogit.control</code></p></dd>


  <dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object that inherits class <code>"mclogit"</code>.
    When passed to <code><a href="dispersion.html">dispersion()</a></code>, it
    should be the result of a call of <code>mclogit()</code> of
    <code><a href="mblogit.html">mblogit()</a></code>, <em>without</em> random effects.</p></dd>

  <dt id="arg-formula-">formula.<a class="anchor" aria-label="anchor" href="#arg-formula-"></a></dt>
<dd><p>a changes to the model formula,
    see <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update.default</a></code> and
    <code><a href="https://rdrr.io/r/stats/update.formula.html" class="external-link">update.formula</a></code>.</p></dd>

  <dt id="arg-correlation">correlation<a class="anchor" aria-label="anchor" href="#arg-correlation"></a></dt>
<dd><p>logical; see <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm</a></code>.</p></dd>

  <dt id="arg-symbolic-cor">symbolic.cor<a class="anchor" aria-label="anchor" href="#arg-symbolic-cor"></a></dt>
<dd><p>logical; see <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>mclogit</code> returns an object of class "mclogit", which has almost the
  same structure as an object of class "<a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a>".</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Covariates that are constant within choice sets are automatically
  dropped from the model formula specified by the <code>formula</code>
  argument of <code>mclogit</code>.</p>
<p>If the model contains random effects, these should</p><ul><li><p>either vary within choice sets (e.g. the levels of a factor
    that defines the choice sets should not be nested within the levels
    of factor)</p></li>
<li><p>or be random coefficients of covariates that vary within
    choice sets.</p></li>
</ul><p>In earlier versions of the package (prior to 0.6) it will lead to a
  failure of the model fitting algorithm if these conditions are not
  satisfied. Since version 0.6 of the package, the function
  <code>mclogit</code> will complain about such model a misspecification
  explicitely.</p>
<p>From version 0.9.7 it is possible to choose the optimization
  technique used for the inner iterations of the PQL/MQL: either
  <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> (the default), <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm</a></code>,
  or any of the algorithms (other than "Brent" supported by
  <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).  To choose the optimizer, use the
  appropriate argument for <code><a href="mclogit_control.html">mmclogit.control</a></code> .</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Agresti, Alan (2002).
    <em>Categorical Data Analysis.</em> 2nd ed, Hoboken, NJ: Wiley.
    <a href="https://doi.org/10.1002/0471249688" class="external-link">doi:10.1002/0471249688</a></p>
<p>Breslow, N.E. and D.G. Clayton (1993).
    "Approximate Inference in Generalized Linear Mixed Models".
    <em>Journal of the American Statistical Association</em> 88 (421): 9-25.
    <a href="https://doi.org/10.1080/01621459.1993.10594284" class="external-link">doi:10.1080/01621459.1993.10594284</a></p>
<p>Elff, Martin (2009).
    "Social Divisions, Party Positions, and Electoral Behaviour".
    <em>Electoral Studies</em> 28(2): 297-308.
    <a href="https://doi.org/10.1016/j.electstud.2009.02.002" class="external-link">doi:10.1016/j.electstud.2009.02.002</a></p>
<p>McFadden, D. (1973).
    "Conditionial Logit Analysis of Qualitative Choice Behavior".
    Pp. 105-135 in P. Zarembka (ed.).
    <em>Frontiers in Econometrics</em>.
    New York: Wiley.
    <a href="https://eml.berkeley.edu/reprints/mcfadden/zarembka.pdf" class="external-link">https://eml.berkeley.edu/reprints/mcfadden/zarembka.pdf</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Conditional logit models are also supported by <span class="pkg">gmnl</span>, <span class="pkg">mlogit</span>, and <span class="pkg">survival</span>.
<span class="pkg">survival</span> supports conditional logit models for binary panel data and case-control studies.
<span class="pkg">mlogit</span> and <span class="pkg">gmnl</span> treat conditional logit models from an econometric perspective.
Unlike the present package, they focus on the random utility interpretation of discrete choice models
and support generalisations of conditional logit models, such as nested logit models, that are intended
to overcome the IIA (indipendence from irrelevant alterantives) assumption. Mixed multinomial models are
also supported and estimated using simulation-based techniques. Unlike the present package,
mixed or random-effects extensions are mainly intended to fit repeated choices of the same individuals and not
aggregated choices of many individuals facing identical alternatives.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Transport</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">mclogit</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">resp</span>,<span class="va">suburb</span><span class="op">)</span><span class="op">~</span><span class="va">distance</span><span class="op">+</span><span class="va">cost</span>,</span></span>
<span class="r-in"><span>  data<span class="op">=</span><span class="va">Transport</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 - deviance = 39.74973 - criterion = 0.8590917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 - deviance = 10.50328 - criterion = 2.758244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 - deviance = 9.231325 - criterion = 0.1363107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 - deviance = 9.227742 - criterion = 0.0003840654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 5 - deviance = 9.227742 - criterion = 3.446459e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mclogit(formula = cbind(resp, suburb) ~ distance + cost, data = Transport)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance -1.43940    0.05318  -27.07   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cost     -0.97753    0.03987  -24.52   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:     2734 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 9.228 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations:  5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations:  1994 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># New syntactic sugar:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">mclogit</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">resp</span><span class="op">|</span><span class="va">suburb</span><span class="op">~</span><span class="va">distance</span><span class="op">+</span><span class="va">cost</span>,</span></span>
<span class="r-in"><span>  data<span class="op">=</span><span class="va">Transport</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 - deviance = 39.74973 - criterion = 0.8590917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 - deviance = 10.50328 - criterion = 2.758244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 - deviance = 9.231325 - criterion = 0.1363107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 - deviance = 9.227742 - criterion = 0.0003840654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 5 - deviance = 9.227742 - criterion = 3.446459e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mclogit(formula = resp | suburb ~ distance + cost, data = Transport)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance -1.43940    0.05318  -27.07   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cost     -0.97753    0.03987  -24.52   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:     2734 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 9.228 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations:  5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations:  1994 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># This takes a bit longer.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">electors</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">electors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">electors</span>,<span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">party.time</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">party</span>,<span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">time.class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">class</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Time points nested within parties</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">mclogit</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Freq</span><span class="op">|</span><span class="va">time.class</span><span class="op">~</span><span class="va">econ.left</span><span class="op">/</span><span class="va">class</span><span class="op">+</span><span class="va">welfare</span><span class="op">/</span><span class="va">class</span><span class="op">+</span><span class="va">auth</span><span class="op">/</span><span class="va">class</span>,</span></span>
<span class="r-in"><span>  random<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">party</span><span class="op">/</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>  data<span class="op">=</span><span class="va">electors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Possible non-convergence of inner iterations - nlminb message: singular convergence (7)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 - deviance = 495.6469 - criterion = 0.1640698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 - deviance = 379.0387 - criterion = 0.02944294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 - deviance = 363.3644 - criterion = 0.006445485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 - deviance = 362.7738 - criterion = 0.0003382211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 5 - deviance = 362.7685 - criterion = 6.930491e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 6 - deviance = 362.7684 - criterion = 2.672469e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mclogit(formula = Freq | time.class ~ econ.left/class + welfare/class + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     auth/class, data = electors, random = ~1 | party/time)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficents:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> econ.left                 -0.04035    0.73004  -0.055   0.9559    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> welfare                    1.95936    1.16585   1.681   0.0928 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> auth                       0.16811    0.62796   0.268   0.7889    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> econ.left:classnew.middle -2.04700    0.11816 -17.324   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> econ.left:classold.middle -3.39457    0.17416 -19.491   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classnew.middle:welfare   -0.75181    0.07501 -10.023   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classold.middle:welfare   -1.27119    0.14517  -8.757   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classnew.middle:auth      -1.49715    0.05188 -28.855   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classold.middle:auth       1.40982    0.05997  23.510   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Co-)Variances:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping level: party </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate   Std.Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          (Const.)   (Const.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Const.)  2.002      2.143  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping level: party:time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate    Std.Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          (Const.)    (Const.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Const.) 2.372e-08   1.09e-24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Approximate residual deviance: 362.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher scoring iterations:  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Groups by party: 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Groups by party:time: 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Individual observations:  37500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Party-level random intercepts and random slopes varying over time points</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">mclogit</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Freq</span><span class="op">|</span><span class="va">time.class</span><span class="op">~</span><span class="va">econ.left</span><span class="op">/</span><span class="va">class</span><span class="op">+</span><span class="va">welfare</span><span class="op">/</span><span class="va">class</span><span class="op">+</span><span class="va">auth</span><span class="op">/</span><span class="va">class</span>,</span></span>
<span class="r-in"><span>  random<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">party</span>,<span class="op">~</span><span class="va">econ.left</span><span class="op">+</span><span class="fl">0</span><span class="op">|</span><span class="va">time</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data<span class="op">=</span><span class="va">electors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1 - deviance = 495.6162 - criterion = 0.1640703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 2 - deviance = 378.9601 - criterion = 0.02945638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 3 - deviance = 363.1957 - criterion = 0.006453599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 4 - deviance = 362.5831 - criterion = 0.0003390485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 5 - deviance = 362.5743 - criterion = 6.960937e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 6 - deviance = 362.574 - criterion = 2.692628e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mclogit(formula = Freq | time.class ~ econ.left/class + welfare/class + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     auth/class, data = electors, random = list(~1 | party, ~econ.left + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0 | time))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficents:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> econ.left                 -0.04034    0.73006  -0.055   0.9559    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> welfare                    1.95937    1.16587   1.681   0.0928 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> auth                       0.16811    0.62797   0.268   0.7889    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> econ.left:classnew.middle -2.04703    0.11816 -17.324   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> econ.left:classold.middle -3.39462    0.17416 -19.492   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classnew.middle:welfare   -0.75181    0.07501 -10.023   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classold.middle:welfare   -1.27119    0.14517  -8.757   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classnew.middle:auth      -1.49715    0.05188 -28.855   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> classold.middle:auth       1.40982    0.05997  23.510   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Co-)Variances:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping level: party </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Estimate   Std.Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          (Const.)   (Const.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Const.)  2.002      2.143  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping level: time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate    Std.Err. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           econ.left   econ.left</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> econ.left 0.0002345   2.579e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Approximate residual deviance: 362.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher scoring iterations:  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Groups by party: 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Groups by time: 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Individual observations:  37500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> <span class="co"># \dontrun{}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Elff.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

